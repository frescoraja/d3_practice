<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="../d3.min.js" type="text/javascript"></script>
    <title>D3 visualize sorting</title>
	</head>
	<body>
		<canvas id="canvas"></canvas>
		<script>
			const num = 10000;
			const canvas = document.getElementById("canvas");
			const width = canvas.width = 960;
			const height = canvas.height = 600;
			const ctx = canvas.getContext("2d");

			let particles = d3.range(num).map(i => (
				[Math.round(width * Math.random()), Math.round(height * Math.random())]
			));

			d3.timer(step);

			function step() {
				ctx.fillStyle = "rgba(255, 255, 255, 0.3)";
				ctx.fillRect(0, 0, width, height);
				ctx.fillStyle = "rgba(0, 0, 140, 0.5)";
				particles.forEach(p => {
					p[0] += Math.round(Math.random() * 2) - 1;
					p[1] += Math.round(Math.random() * 2) - 1;
					if (p[0] < 0) p[0] = width;
					if (p[0] > width) p[0] = 0;
					if (p[1] < 0) p[1] = height;
					if (p[1] > height) p[1] = 0;
					drawpoint(p);
				});
			}

			function drawpoint(p) {
				ctx.fillRect(p[0], p[1], Math.ceil(Math.random() * 2), Math.ceil(Math.random() * 2));
			}
		</script>
	</body>
</html>
